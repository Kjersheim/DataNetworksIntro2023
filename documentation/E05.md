# Documentation for E05

## Plan
- [ ] Add additional lubuntu and router VM
- [ ] Plan addresses and update charts, logical and physical
- [ ] Configure Router A and B
	- [ ] Initial setup
	- [ ] Interfaces and addresses
	- [ ] Checking gateways and remaining configurations
- [ ] Configure Lubuntu3
- [ ] Configure routers routing table
- [ ] Change ip configuration to DHCP on all lubuntus
- [ ] Topology charts
	- [ ] Physical
	- [ ] Logical


## Chosing subnets
From E03, chosing the subnets used for the new devices in the network:


$`\textcolor{limegreen}{ \text{192.168.39.128/26 - 62 avaliable host-addresses subnet - between Lubuntu3 and RouterB}\  } `$
$`\textcolor{navyblue}{ \text{10.8.83.240/30 - 2 avaliable host-addresses subnet - between RouterA and RouterB}\  } `$


### Physical topology draft

![](/documentation/E05/CutoutNewAdditionsPhysical.png)


### Logical topology draft

![](/documentation/E05/CutoutNewAdditionsLogical.png)


At this point I have now made additions in both charts, and cloned a new lubuntu machine and a new router - both with new MAC-addresses.

- [x] Add additional lubuntu and router VM
- [x] Plan addresses and update charts, logical and physical



# Configuring new devices

After the routers first boot up I initially change its name to vyos-router-b. 
 
At the same time I also change the other router that was named vyos-router-1 to vyos-router-a - for similar naming convention.


## Vyos Router A

![](/documentation/E05/RouterNameChange.png)

On router A I added a new adapter during the setup, which I linked to the new internal network named "RoToRo", adapter 2. Checking configurations on the router shows that this new adapter has gotten the eth1 interface. This corresponds with the VM settings of newly added adapter. 

![](/documentation/E05/RouterAeth1.png)![](/documentation/E05/RouterASettingsNewAdapter.png)


Initially I debate if I needed to somehow connect the new router to an existing or new VLAN. Though as the material state, its such a minimal net and we will not fit other devices within this subnet, so its a router to router subnet where I dont need to add a separate VLAN. Deleting the question of new VLAN from my physical topology draft. 
Giving the new interface on router A an ip address:

![](/documentation/E05/RouterAeth1Address.png)


## Vyos Router B

showing interfaces on Vyos Router B:

![](/documentation/E05/RouterBInterfaces.png)

Comparing that to the adapter settings to distinquish which interface goes where.

![](/documentation/E05/RouterBAdapter1.png) | ![](/documentation/E05/RouterBAdapter2.png)

With this information I update the physical topology with interface and MAC addresses, and also add the interfaces to the logical topology. I do notice that for some reason my first router uses interfaces eth0 and eth1, while the second router uses interfaces eth1 and eth2. At this point Im not quite sure why, as so far the setup have been the same. 

![](/documentation/E05/InconsistentInterfacesRouters.png)

Based on the updated logical topology I add the addresses manually to Vyos Router B:

![](/documentation/E05/RouterBeth1_2_ip.png)

Which can be more easier visualized by:

![](/documentation/E05/CurrentLogicalCutout.png)

As a test at this stage, I ping the routers from eachother, successfully:

![](/documentation/E05/RouterPingEachother.png)


- [ ] Configure Router A and B
	- [x] Initial setup
	- [x] Interfaces and addresses
	- [ ] Checking gateways and remaining configurations
	
	
## Lubuntu3

Initially I change the IP settings from the cloned Lubuntu1 to its own, according to the Logical topology chart. 

![](/documentation/E05/Lubuntu3Newaddress.png)

![](/documentation/E05/Lubuntu3Ipaddr.png)

After refreshing the connection, I check the address in the terminal. According to this both the IP is updated as well as lubuntus adapter1 MAC-address is corresponding the physical topology.

![](/documentation/E05/Lubuntu3PhysicalMac.png)

Testing connections by pinging Vyos Router B on .129 from Lubuntu3 on .130:

![](/documentation/E05/Lubuntu3PingRouterB.png)


- [x] Configure Lubuntu3



# Directing the traffic that will pass through the routers

## Symmetric routing between Router A and B.

Starting by adding a route from Vyos Router B to the subnet 192.168.39.64/26 - where Lubuntu2 is a part of the subnet. 
Which, from what I understand, tells the Router B if it wants to send something to that subnet it needs to go by Router As interface eth1.

![](/documentation/E05/StaticRouteRouterBLubuntu2.png)

Second I also want to add a similar route the opposite way, where I guess the term "symmetric" comes from. 

Setting up a route from Vyos Router A to the subnet 192.168.39.128/26, the new subnet where Lubuntu3 is located., telling it to send traffic in that direction through Router Bs interface eth1.

![](/documentation/E05/StaticRouteRouterALubuntu3.png)

To test this connection I perform a ping from Lubuntu3 towards Lubuntu2:

![](/documentation/E05/PingLubuntu2FromLubuntu3.png)
