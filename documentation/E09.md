# Documentation for E09

# Network segmentation and firewalls

## Plan


- [ ]  Prepare the topology
	- [ ] Update Physical schematic
	- [ ] Update Logical schematic
	- [ ] Add DHCP server on Router C to distribute addresses to the new public subnet 
	- [ ] Add new topology to the dynamic routing 

- [ ] Configure firewall settings to Router C
		- [ ] Add and visualize 3 policy areas

# Preparing changes in topology

To prepare the added WAN and use of Router C as a firewall, I create an additional interface with this purpose.

>![](/documentation/E09/NewInterfaceRouterC.png)

Looking through former exercises to find a suitable public IPv4 address space for testing, I find that the ones I researched earlier are mostly unresponsive. 
I chose to add **104.244.42.129** which is the address I get directed to when I ping twitter.com.

Before adding the address, I try to identify the subnet mask, in case thats required to add it. For testing purposes I will try to add without. Furthermore, trying to see
if there is a way this information is avaliable to the public I do a quick lookup on a slightly unsecured website:

>![](/documentation/E09/Tryingtofindsubnetmask.png)

I add the address to the new interface on Vyos Router C. 

>![](/documentation/E09/RouterCNewInterfaceEth2.png)

in the process I get info I do need to add the right format, aka. with a subnet-mask. However, as seen below.. any will do, so not sure what this does. 
I still chose finally to go with the supernet initially found. 
>![](/documentation/E09/Needprefix.png)

>![](/documentation/E09/AddingRouterCEth2Supernet.png)

I realize this is a huge supernet, but still just adding a few addresses in range from the dhcp server I set up on the router, for testing. Now, this makes me question some things. I am still barely grasp the functionality and processes of a network, so I take a step back. 
Thinking I can probably add a subnet from the information gathered above, and as of yet it is still only reachable on my own virtualized network. However, to avoid any issues and also chosing a smaller subnet I decide to pick one from my previous E03 Exercise:


|43.08.39.0/24|
|---|
||
|Address:   43.08.39.0            00101011.00001000.00100111 .00000000|
|Netmask:   255.255.255.0 = 24    11111111.11111111.11111111 .00000000|
|Wildcard:  0.0.0.255             00000000.00000000.00000000 .11111111|
|Network:   43.8.39.0/24          00101011.00001000.00100111 .00000000 (Class A)|
|Broadcast: 43.8.39.255           00101011.00001000.00100111 .11111111|
|HostMin:   43.8.39.1             00101011.00001000.00100111 .00000001|
|HostMax:   43.8.39.254           00101011.00001000.00100111 .11111110|
|Hosts/Net: 254|


            
# Notes

> perimeter defence around network segments

Filtering decisions within a firewall are typically installed in a 'firewall rule table'

Network segments typically means a sub/supernet. 'Policy' zones can contain several subnets within the zone, where all sub/supernets can share a policy.

Create an array - of a group/several subnets that can belong to the same cathegory of policies. "Categorization of network segments".
> Whitelist devices and groups that should have access, and deny anything else. 


**Stateful** Firewalls: 
The state table is a dynamic rule table, that reflects accepter traffics both directions. If something is accepted out, it is also accepted in.  Bidirectional.

**Stateless** need to both accept in AND out. Unidirectional.


>High availability (HA) allows you to place two firewalls in a group and synchronize their configuration. This prevents a single point of failure on your network. The two firewalls have a heartbeat connection, which ensures failover if one of the firewalls goes down
If firewalls are connected as such they might need a "heartbeat" cable to ensure syncronization of data. 


