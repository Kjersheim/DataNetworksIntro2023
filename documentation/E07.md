# Documentation for E07

The functionality of a switch is to learn about their surroundings. When the switch receive an ethernet frame, and build up their forwarding table - "MAC-address table, -show fdb", they start to forward traffic in an ethernet network. 
If a switch do not have a destination MAC-address, an unknown address that is not in the FDB, the switch will spam out unknown MAC-addresses. "Unknown dstMAC frames" out of all ports. 

Within a RING topology, this is bad if there is no loop-detection, and it will form an infinite repetition loop. **Ethernet frames do not have TTL-field.**

```
Following the thread on this one to elaborate.

Historically it seems that a TTL-field on the ethernet frames were not, thought of or needed when they were introduced due to the limited complexities within networks, before switches and such were invented. 
Why not add it in later on? From what I have gained, a TTL-field would in the end just stop the one frame, and not fix an underlying issue of looping frames. 

From what I understand, if a host is caught in a loop, it is unaccessible from other hosts on the network. A "broadcast storm" can occur when there are so many frames in a loop that all avaliable bandwidth
is consumed. A TTL value would still have the frame run a loop, just not indefinitely, but long enough to cause problems? Can it be compared to a denial of service attack? 
In such a broadcast storm the forwarding tables are constantly updated with MAC-addresses, and even though the packet finally arrives at the correct destination it seems the tables are constantly faulty updated so the answer wont
be sent to the right recipient.

In the end, would not a TTL-field atleast help? But perhabs its still too little help to fix the issue. There will always be loops in a network which have been designed to avoid a single point of failure, 
and have multiple "roads". when this redundancy is introduced, loops and duplicate frames occur.  Despite the questions of TTL, this is the reason why The Spanning Tree Protocol was created, and from what I can see before entering
the materials is that it fixes the issues and TTL is out of the question. 

```




# Spanning Tree Protocol


## Plan

- [ ] Update and review current topology
	- [ ] Add Network_Switch_C to the topology, RING-topology
	- [ ] Move Lubuntu2 machine behind Network_Switch_C
	- [ ] Update adapters VirtualBox
	
- [ ] Configuration, update VLAN
	- [ ] Switch A
	- [ ] Switch B
	- [ ] Switch C

- [ ] Testing STP
	- [ ] Switch A to B
	- [ ] Switch C to B
	- [ ] Creating a loop
	
- [ ] Spanning Tree Protocol
	- [ ] Update topology schematic
	- [ ] Enable on all 3 Switches
	- [ ] Investigate port states
	- [ ] Define Root Switch
	- [ ] Testing
	
# Update and review current topology

First steps is to clone a switch and add it to the schematic, set as a RING with the other switches. Then moving Lubuntu2 behind the new switch. 


## Draft of physical topology changes


![](/documentation/E07/E07NetworkCharts-Physical_Topology_draft3.png)

## Updating adapters

After drafting the physical changes, I start checking the adapters in VirtualBox, to make sure the "cables and interfaces" are correct. 

![](/documentation/E07/AdaptersSwitchA.png)
![](/documentation/E07/AdaptersSwitchB.png)

![](/documentation/E07/AdaptersSwitchC.png)


- [x] Update and review current topology
	- [x] Add Network_Switch_C to the topology, RING-topology
	- [x] Move Lubuntu2 machine behind Network_Switch_C
	- [x] Update adapters VirtualBox


## Updating VLAN & tagging ports

![](/documentation/E07/SwitchAtagging1.png)

- [x] Switch A
	
![](/documentation/E07/SwitchBtagging.png)

- [x] Switch B
	
![](/documentation/E07/SwitchCtagging.png)

In addition to this, adding a new ip-address and a gateway to Switch C.

![](/documentation/E07/SwitchCIpAndGateway.png)

- [x] Switch C
- [x] Configuration, update VLAN

# Connectivity tests pre-STP

## Switch A and B online, Switch C offline

Powering up all 3 Lubuntus, both routers and the abovementioned Switch A and B. 

Initially I ping Lubuntu3 from Lubuntu1:

![](/documentation/E07/PingL1L3.png)

Then I ping various devices from Lubuntu3:

![](/documentation/E07/L3Ping_1.png)

Seeing that Network_Switch_C is offline, any response from Lubuntu2 is not going to happend, as Lubuntu2 is only connected to Network_Switch_C.


## Switch B and C online, Switch A offline

Shutting down Switch A, powering up Switch C. 

Lubuntu3 to Lubuntu2:

![](/documentation/E07/PingL3L2.png)

Lubuntu 2 to different parts of the topology:

![](/documentation/E07/L2Ping_1_1.png)



