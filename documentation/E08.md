# Documentation for E08

## Plan

- [ ] Update topology
	- [ ] Physical schematic
	- [ ] Logical schematic

- [ ] Update & add virtual machines
	- [ ] Configuration of new router
	- [ ] Loopback interfaces

- [ ] Configure OSPF on routers
	- [ ] Dynamic routing
	- [ ] Checking for routing table
	
- Connectivity tests

- Configure cybersecurity to OSPF


# Updating topology

## Physical topology
![](/documentation/E08/E08NetworkCharts-PhysicalTopologyDraft1.png)

## Logical topology
![](/documentation/E08/E08NetworkCharts-LogicalTopologyDraft1.png)



- [x] Update topology
	- [x] Physical schematic
	- [x] Logical schematic



# Update & add virtual machines
Subnet No. 1

10.08.83.244/30 (0100) Between Vyos router B and C


Subnet No. 2

10.08.83.248/30 (1000) Between Vyos router A and B



Renaming Vyos Router C, initial configuration:

```	
'configure
	set system host-name [name]
	commit
	save
	exit'

Requires a full reboot of the Vyos virtual machine to take affect.
'poweroff 
y'

Checking interfaces on Vyos Router C:
'show configuration'

comparing interfaces to the adapters on the virtual machine. Updating logical and physical topology. 


Adding ip-addresses to interfaces:

Since I dont have any VLANS within the two new subnets, I set the ip address directly on the interfaces and not adding the vif option. 

' set interfaces ethernet eth3 address 10.8.83.246/30
  set interfaces ethernet eth0 address 10.8.83.250/30 
  commit
  save '

```	

![](/documentation/E08/RouterCAddresses.png)

Eventually I check the addresses and add them to each interface eth0 and eth3. 

I chose to delete the previous established static routes that were cloned from the original router. Not sure if this was neccesary if we are adding dynamic routing, but I think they would nomatter be wrong. 

![](/documentation/E08/DeletingRoutes.png)


Finally I check the configuration of the new interfaces on Vyos Router A and B, and add them to the topologies. 

![](/documentation/E08/NewCablesRouterAB.png)

From this I start a test pinging between routers. 
- Ping between Router A and B is positive. 
- Ping between Router B and C is positive. 
- Ping between Router A and C is positive. 

![](/documentation/E08/InitialRouterPingTests.png)

Ping outside of each subnet however is not yet possible, as no gateways or routing has been set. 

- [ ] Update & add virtual machines
	- [x] Configuration of new router
	- [ ] Loopback interfaces


# Addressing loopback interfaces

Initially I am trying to understand where the loopback io would belong within the OSI model. 

## Describing the subnets to use
```
"parent" subnet:
10.08.83.252/30
```

Approaching this made me need to step back to have a look on previous made subnets and the lessons I have learned so far. We could say that the /30 or /32 does not refer to the size of the 
subnet, but rather the range within. Thinking like this makes more sense, but still does not explain the regular information we have about subnets so far. 
Quite clearly there is no room for a subnet- or broadcastaddress within. /32 would have a subnet-mask of 255.255.255.255, and would only contain one single host. 
From some research I find that these are used for specific purposes, as loopback interfaces or a "host route". 

On my Vyos Router A I can see that 127.0.0.1 is refered to as link/loopback:

![](/documentation/E08/routeripaddress.png)

Previously I am familiar with this address described as "localhost", or the machine itself. Doing a quick search also shows the description that
the loopback address refers to the fact that no data packet addressed to 127.0.0.1 should leave the computer/host, 
and sending it the packet gets "looped back" to on itself, so the sender becomes the recipient. 

For example, previously we used an extension on Vistual Studio Code to host a webserver locally, on 127.0.0.1 :5500.


RFC1122 refers to the address 127.0.0.1 as a internal host loopback address, and no other addresses of this form must appear outside the host. 
Routers that pick up traffic from the address are supposed to drop the packets immidiately. Whilst trying to focus on the framework of the assignment,
it is curious to consider the use/purpose/plan for the rest of the addresses within 127.0.0.1 to 127.255.255.255, where the whole block is reserved.

Continuing on the exercise I believe the subnet mentioned above can be divided. Since I need two of the total 4 addresses avaliable, Ill describe those. 
If there are uses of a /31 or 2 host(well thats basically just a broadcast and a subnetaddress and no hosts) Ill leave the last 2 addresses be for now.

- 10.8.83.252/32
- 10.8.83.253/32































Notes:
- Last week "switching loops" in OSI L2. Also a phenomenon called "routing loops" on L3. TTL-field in L3-packets helps preventing meltdowns.
- Static routing vs dynamic routing. Instead of creating routes, the router devices broadcast information and listen to information between eachother "adjacencies". 
- Large scale, distance vector. Distance/direction. Main protocol in this course is called Border Gateway Protocol.
- OSPF Open Shortest Path First. Calculating cost of each route by measuring/taking the metric(calculations) based on links between devices, cable quality, distance and such. 
Djikstra's algoritmn, which tell the shortest path from _one_ node to every other node. 

- Changing bandwidth reference must be done on all routers. This seems to be quite vital in particularily fast ethernets. By default the reference-bandwidth is 100 Mbits/sec. 
If you then have a 100 Mbits line, it has a cost of 1. Seeing then that you also have a line of 10 Gbit, the cost-value can not be lower than 1, hence it gets registred with the same cost. 
To take advantage of faster speeds, change the reference value. 

Adjacencies between routers are formed through exchange of OSPF -packets. 

Router-ID is the IPv4 address, set by the admin. This so the routers will know who is where/what. If this is not done/forgotten - default is that the highest binary value of the IPv4 addresses of loopback interfaces. 
Lastly if this is not avaliable, the highest IPv4 of other interfaces will be the ID. 


![](/documentation/E08/RouterRelationship_NetworkTypesOSPFv2.png)

![](/documentation/E08/OSPFNeighborshipStates.png)

- show ip route

C, physically connected, routes are better than dynamically learnt routes. 

- show ip ospf

instability? check SPF run times. If instability, it updates and runs many times. 
